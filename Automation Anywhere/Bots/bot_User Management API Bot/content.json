{"triggers":[],"nodes":[{"uid":"af5e1841-a638-46cf-b2f6-8a6f36a47ff5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Generating Token for Authentication"}}]},{"uid":"c0f06c83-f37e-4671-951c-6582b995dab4","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"0f8a9f02-c3af-4663-bf49-c2a09660f19c","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uri","value":{"type":"STRING","expression":"$sCRURL$/v1/authentication"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"{\n\"username\": \"$sUserName$\",\n\"password\": \"$sPassword$\"\n}"}}],"returnTo":{"type":"VARIABLE","variableName":"dToken"}},{"uid":"c479284d-edf8-49a3-9130-570d6bf2263b","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dToken{Body}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"fb42bbab-89a6-4f4a-a8d6-ccf8afdffbd1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extracting Token for Authentication from Response"}}]},{"uid":"437cd778-5f64-46aa-9cdb-1cc09e738e1f","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dToken{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"token\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sToken"}},{"uid":"ef2517b8-517f-4a59-838b-6013f0f6aabf","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sToken$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e8fd21de-11ab-40ed-8587-8f6978be0641","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Validating the Token Generated"}}]},{"uid":"b49e5916-7f08-466f-b9d9-550cace05cd1","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uri","value":{"type":"STRING","expression":"$sCRURL$/v1/authentication/token?token=$sToken$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}}],"returnTo":{"type":"VARIABLE","variableName":"dValidation"}},{"uid":"cac21005-21a6-4f00-954f-7e6fc8b9285e","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dValidation{Body}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"bcf523bf-cd0d-491b-a2c1-20322974756f","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"nloopCounter"}},{"uid":"e05979ab-5378-445c-80c7-0ccbb18a0755","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/Administrator/Desktop/Users%20template%5BEXAMPLE%5D.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"ExcelSession1"}},{"uid":"d09bada0-4211-4edc-9e19-382a1d7820ac","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"38dfb20a-188a-41f9-a35f-d8d450b4c775","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nloopCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nloopCounter"}},{"uid":"fde83c54-7e22-4770-82d5-e910571fc5fe","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3c679824-3f80-47ce-9808-a4b9c9dbcdd7","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$nloopCounter$"}},{"name":"operator","value":{"type":"STRING","string":"LTE"}},{"name":"value","value":{"type":"NUMBER","number":"3"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"c09152be-b197-46a7-bfd4-ad5b7d3b975a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get Roles List"}}]},{"uid":"f416b7da-5b4f-4095-a149-6d09e6f1417d","commandName":"restPost","packageName":"Rest","disabled":true,"attributes":[{"name":"uri","value":{"type":"STRING","expression":"$sCRURL$/v1/usermanagement/roles/list"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"PROPERTIES","properties":[{"type":"STRING","name":{"type":"STRING","string":"X-Authorization"},"value":{"type":"STRING","expression":"$sToken$"},"enabled":true}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"jsonPostParameters","value":{"type":"STRING","string":"{\n\"sort\": [\n  {\n   \"field\": \"name\",\n   \"direction\": \"asc\"\n  }\n],\n\"filter\": {\n  \"operator\": \"substring\",\n  \"value\": \"\",\n  \"field\": \"name\"\n},\n\"fields\": [],\n\"page\": {\n  \"offset\": 0,\n  \"total\": 23,\n  \"totalFilter\": 23,\n  \"length\": 200\n}\n}"}}],"returnTo":{"type":"VARIABLE","variableName":"dRoles"}},{"uid":"a2b100f1-8a4a-4e7c-97c8-81aebdcd0a8e","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uri","value":{"type":"STRING","expression":"$sCRURL$/v1/usermanagement/roles/list"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"PROPERTIES","properties":[{"type":"STRING","name":{"type":"STRING","string":"X-Authorization"},"value":{"type":"STRING","expression":"$sToken$"},"enabled":true}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"{\n\"sort\": [\n  {\n   \"field\": \"name\",\n   \"direction\": \"asc\"\n  }\n],\n\"filter\": {\n  \"operator\": \"substring\",\n  \"value\": \"$ExcelRow[7]$\",\n  \"field\": \"name\"\n},\n\"fields\": [],\n\"page\": {\n  \"offset\": 0,\n  \"total\": 23,\n  \"totalFilter\": 23,\n  \"length\": 200\n}\n}\n"}}],"returnTo":{"type":"VARIABLE","variableName":"dRoles"}},{"uid":"b6ef9ae9-8e25-42c8-9a3f-e328250410fa","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dRoles{Body}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"2cb995be-5cfa-4e2f-aad3-6e66032c0023","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dRoles{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"id\":"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\"name\":"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sRoleID"}},{"uid":"28368c03-a4c6-41cb-bf2f-6771470178f6","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRoleID$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"sRoleID"}},{"uid":"fd8ce0a5-0255-41ef-aece-8cac9df766f1","commandName":"trim","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRoleID$"}},{"name":"trimAtBeginning","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimAtEnd","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sRoleID"}},{"uid":"c070ee9e-908c-45ea-8eef-9603b955299a","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sRoleID$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"fde271d5-809c-4abb-bb6e-0901c4254832","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Create Bot User"}}]},{"uid":"f0805fc2-35db-492a-a257-5927598ca6bf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{  \"roles\": [    {      \"id\":$sRoleID$    }  ],  \"domain\": \"$ExcelRow[5]$\",  \"email\": \"$ExcelRow[0]$\",  \"enableAutoLogin\": false,  \"username\": \"$ExcelRow[1]$\",  \"firstName\": \"$ExcelRow[2]$\",  \"lastName\": \"$ExcelRow[3]$\",  \"description\": \"$ExcelRow[4]$\",  \"disabled\": false, \"password\": \"Admin123\",  \"licenseFeatures\": [    \"$ExcelRow[6]$\"  ]}"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"f9749a63-6ad8-44bd-b337-a8b707a5a471","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uri","value":{"type":"STRING","expression":"$sCRURL$/v1/usermanagement/users"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"PROPERTIES","properties":[{"type":"STRING","name":{"type":"STRING","string":"X-Authorization"},"value":{"type":"STRING","expression":"$sToken$"},"enabled":true}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$prompt-assignment$"}}],"returnTo":{"type":"VARIABLE","variableName":"dUser"}},{"uid":"6e3d7088-5ebc-4efc-885e-a2c546d02d18","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dUser{Body}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"dee55a60-c575-49b9-b8f8-30ed4e7bf401","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dUser{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"id\":"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":",\"username\""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sUserId"}},{"uid":"31826650-0e1f-4ed6-9c51-4db3c0653d8b","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sUserId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"fe5bfce0-2301-4e92-8af2-374c576ac3f5","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"I$nloopCounter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"User ID - $sUserId$"}},{"name":"session","value":{"type":"SESSION","expression":"$ExcelSession1$"}}]},{"uid":"5c965b36-4eaf-40b1-9365-45b03cdfc6df","commandName":"SaveSpreadSheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","expression":"$ExcelSession1$"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"ExcelRow"},"attributes":[{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"session","value":{"type":"SESSION","expression":"$ExcelSession1$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel"}}]}],"branches":[{"uid":"d249b5cc-89e9-49c3-ac63-8ea2ed6ccb24","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"b05b8992-a265-4370-ae82-8665db73e606","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sErrorDescription$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"dToken","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sToken","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dValidation","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dRoles","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sRoleID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dUserList","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dUser","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sUserId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"938"}},{"name":"fPwdForm","description":"","type":"FORM","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"FORM","file":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bot%20Store/Bot%20Submission%20Rajat/Password%20Update%20Form"}}},{"name":"sUserName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"api_user"}},{"name":"sPassword","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Automation123"}},{"name":"sCRURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"http://nafisvm11101013.aaiproductdemo.com"}},{"name":"sErrorDescription","description":"Error Description","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLineNumber","description":"Error Line Number","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nloopCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ExcelRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"ExcelSession1","description":"","type":"SESSION","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","sessionType":"Excel"},{"name":"nUserID","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":["af5e1841-a638-46cf-b2f6-8a6f36a47ff5"],"packages":[{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"Excel","version":"2.13.0-20220120-063927"},{"name":"If","version":"3.4.0-20220127-062702"},{"name":"Loop","version":"3.4.0-20220127-062837"},{"name":"MessageBox","version":"2.0.0-20200515-071511"},{"name":"MessageBox","version":"2.0.0-20200515-071511"},{"name":"Number","version":"3.4.0-20220118-133837"},{"name":"Rest","version":"2.0.0-20200515-071712"},{"name":"Rest","version":"2.0.0-20200515-071712"},{"name":"String","version":"3.0.0-20200515-071729"},{"name":"String","version":"3.0.0-20200515-071729"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}